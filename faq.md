# 本ページはメンテナンス中です。

[↑目次に戻る](./README.md)
<br>
# よくあるご質問

本ページでは、SmartCS x Ansible の連携機能を利用するにあたり、SmartCS の動作、設定方法、Ansible 連携機能などに関連するよくあるご質問と回答を掲載しています。  

<br>

## 目次
- [1. SmartCS を経由して手動で接続しているシリアルセッションの切断方法を教えてください。](./faq.md#1-smartcs-を経由して手動で接続しているシリアルセッションの切断方法を教えてください)
- [2. 拡張ユーザ(extusr グループのユーザ)の用途を教えてください。](./faq.md#2-拡張ユーザextusr-グループのユーザの用途を教えてください)
- [3. ポートユーザ(portusr グループのユーザ)で 93xx ポート(SSH トランスペアレント接続機能のポート)へ手動で接続した際のセッション切断方法を教えてください。](./faq.md#3-ポートユーザportusr-グループのユーザで-93xx-ポートSSH-トランスペアレント接続機能のポートへ手動で接続した際のセッション切断方法を教えてください)
- [4. smartcs_tty_command モジュールを使用した Playbook は、どのような手順で作成すれば良いでしょうか。](./faq.md#4-smartcs_tty_command-モジュールを使用した-Playbook-はどのような手順で作成すれば良いでしょうか)
- [5. sendchar オプションで指定した文字列はどのような順番で実行されるのでしょうか。また、recvchar オプションで指定する文字列は、sendchar オプションで指定する文字列と記載する順番を合わせる必要があるのでしょうか。](./faq.md#5-sendchar-オプションで指定した文字列はどのような順番で実行されるのでしょうかまたrecvchar-オプションで指定する文字列はsendchar-オプションで指定する文字列と記載する順番を合わせる必要があるのでしょうか)
- [6. custom_response オプションを有効にした際の stdout_lines_custom において、一つの送信コマンドに対するresponse はどのように判断しているのでしょうか。また、設定反映時のログ情報がコンソールに出力されるのですが、どのように対処すれば良いでしょうか。](./faq.md#6-custom_response-オプションを有効にした際の-stdout_lines_custom-において一つの送信コマンドに対するresponse-はどのように判断しているのでしょうかまた設定反映時のログ情報がコンソールに出力されるのですがどのように対処すれば良いでしょうか)

<br>
<br>

### 1. SmartCS を経由して手動で接続しているシリアルセッションの切断方法を教えてください。
SmartCS のダイレクトモード、セレクトモードで接続しているシリアルセッションは、tty ごとに設定可能な`Ctrl+XX` という切替え文字で切断することができます。  
デフォルトでは設定無しとなっているため、`set portd tty cmdchar` コマンドで設定する必要があります。  
例えば、`set portd tty 1 cmdchar 01` と実行すると、tty1 の切替え文字コードとして`Ctrl+A` が設定されます。  

### 2. 拡張ユーザ(extusr グループのユーザ)の用途を教えてください。
拡張ユーザ(extusr グループ)は設定により権限を付与できるユーザです。  
tty マネージ機能の権限を付与することで、Ansible と連携して SmartCS modules for Ansible を利用することが可能となります。  

各ユーザの権限は下記の通りで、拡張ユーザは基本的に手動での接続には利用しないユーザです。  
・一般ユーザ：SmartCS へ本体ログインし、設定情報の取得、および設定変更を除くコマンド実行が可能なユーザ  
・装置管理ユーザ：一般ユーザや拡張ユーザから su コマンドで移行し、設定情報の取得、および設定変更を含む全てのコマンド実行が可能なユーザ  
・ポートユーザ：SmartCS のポートサーバーへアクセスし、シリアルポートに接続された装置へアクセスするためのユーザ  
・拡張ユーザ：一般ユーザの権限に加え、Ansible と連携してシリアルポートに接続された装置へアクセス可能なユーザ  

### 3. ポートユーザ(portusr グループのユーザ)で 93xx ポート(SSH トランスペアレント接続機能のポート)へ手動で接続した際のセッション切断方法を教えてください。
93xx ポートはベンダーモジュール連携機能を実行する際に使用するポートであり、手動でのシリアルポート接続を想定しておりません。  
切替え文字( Ctrl+XX )の入力でセッションを切断することはできませんので、Teraterm などご利用のターミナルソフトを閉じてセッションを切断してください。  

### 4. smartcs_tty_command モジュールを使用した Playbook は、どのような手順で作成すれば良いでしょうか。
`smartcs_tty_command` モジュールを利用する場合、送信する文字列(sendchar)と受信が期待される文字列(recvchar)をPlaybook に記載する必要があります。  

①実行するコマンド(sendchar)、受信するプロンプトなど(recvchar)を実際に確認しPlaybook を作成  
②作成したPlaybook が正しく動作するかどうかを確認  
という手順となります。  

コンソールログの出力や、接続時のコンソールの状態(ログイン前、ログイン後、コンフィギュレーションモード、など)を考慮する必要があります。  

### 5. sendchar オプションで指定した文字列はどのような順番で実行されるのでしょうか。また、recvchar オプションで指定する文字列は、sendchar オプションで指定する文字列と記載する順番を合わせる必要があるのでしょうか。
`sendchar` オプションで指定した文字列はリストの上から順番に送信されます。  
また、`recvchar` オプションで指定する文字列の順番は`sendchar` オプションで指定する文字列と合わせる必要はありません。リスト内のいずれかの文字列を受信すると、次の`sendchar` を送信します。  

### 6. custom_response オプションを有効にした際の stdout_lines_custom において、一つの送信コマンドに対するresponse はどのように判断しているのでしょうか。また、設定反映時のログ情報がコンソールに出力されるのですが、どのように対処すれば良いでしょうか。
`custom_response` オプションを有効にした際に出力される`stdout_lines_custom` の`response` 部分には、`sendchar` オプションで指定した文字列(execute_command に格納される内容)を送信してから、`recvchar` オプションで指定した文字列のいずれかを受信するまでの入出力情報が含まれます。  
`stdout_lines_custom` に含まれる`response` から必要な部分だけをパースしていただくか、設定反映時のログ情報などの不要な行を削除していただくことになります。  


[↑目次に戻る](./README.md)
